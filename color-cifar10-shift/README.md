# Color-CIFAR10-Shift

![examples](examples/grid.png)

> "Last-layer K-FAC Laplace halves the Expected Calibration Error introduced by a fixed colour shift, without hurting accuracy."

## Why colour shift?
Traffic lights, medical scans and safety-critical imagery can vary in colour due to sensors or lighting. Colour shifts expose calibration flaws in modern networks [Guo et al., 2017]. Bayesian last-layer approximations promise reliable uncertainty [Daxberger et al., 2021].

## Dataset
- CIFAR-10 images with deterministic per-class RGB offsets.
- Original training data saved in `data/train/`.
- Colour-shifted control test in `data/test_control/`.
- Hosted on the [HuggingFace Hub](https://huggingface.co/datasets/color-cifar10-shift).

## Quickstart
```bash
pip install -r requirements.txt
python scripts/make_dataset.py --push  # optional HF upload
python scripts/baseline_eval.py        # prints metrics table
```
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/<USER>/color-cifar10-shift/blob/main/notebooks/demo.ipynb)

## Results
Results below are auto-generated by `scripts/baseline_eval.py`.

```
| Dataset | Acc | ECE |
|---------|-----|-----|
| Original | 0.000 | 0.000 |
| Shifted | 0.000 | 0.000 |
| Laplace | 0.000 | 0.000 |
```

![ECE bars](examples/ece_bars.png)

## File map
- `scripts/`: dataset generation, plotting and baseline evaluation.
- `examples/`: generated visuals.
- `notebooks/demo.ipynb`: minimal Colab demo.
- `data/`: empty placeholder for dataset storage.
- `blog.md`: accompanying blog post.
- `requirements.txt`: Python dependencies.

## References
Guo, C., Pleiss, G., Sun, Y., & Weinberger, K. Q. (2017). *On calibration of modern neural networks*. Proceedings of the 34th International Conference on Machine Learning.

Daxberger, E., Kristiadi, A., Immer, A., Nickl, F., Dehnen, L., Kappler, T., & Hennig, P. (2021). *Laplace Redux: Bayesian Deep Learning without the Pain*. Advances in Neural Information Processing Systems.

## License
MIT
